<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>–ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä</title>

  <!-- PWA Meta -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#121212">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icon-192.png">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ!'))
        .catch(err => console.error('Service Worker –≥—Ä–µ—à–∫–∞:', err));
    }
  </script>

  <style>
    :root { color-scheme: dark; }
    html, body { width: 100%; box-sizing: border-box; }
    body {
      background: #121212;
      color: #ffffff;
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 1rem;
      max-width: 380px;
      margin: auto;
    }
    h1 {
      font-size: 22px;
      text-align: center;
      margin-bottom: 1rem;
      color: #4CAF50;
      border-bottom: 1px solid #333;
      padding-bottom: 8px;
      text-shadow: 0 0 5px #4caf50a1;
    }
    .tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 1.2rem;
    }
    .tabs button {
      flex: 1;
      padding: 0.6rem;
      font-size: 13px;
      background: linear-gradient(to right, #1e1e1e, #2a2a2a);
      color: #fff;
      border: 1px solid #444;
      border-radius: 10px;
      transition: 0.3s ease;
      box-shadow: 0 0 4px #00000055;
      -webkit-tap-highlight-color: transparent;
    }
    .tabs button:hover {
      background: #333;
    }
    .tabs button.active {
      border-bottom: 3px solid #4CAF50;
      font-weight: 600;
    }
    .section {
      display: none;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .section.active {
      display: block;
      opacity: 1;
    }
    label {
      font-size: 13px;
      font-weight: 600;
      margin-top: 1rem;
      display: block;
      color: #eeeeee;
    }
    input, select, button {
      width: 95%;
      padding: 8px 12px;
      margin-top: 6px;
      font-size: 15px;
      background: #ffffff;
      color: #000;
      border: 1px solid #4CAF50;
      border-radius: 10px;
      outline: none;
      transition: 0.2s;
      box-shadow: 0 0 4px #4caf5025;
    }
    input:focus, select:focus, button:focus {
      border-color: #66bb6a;
      box-shadow: 0 0 6px #66bb6a88;
    }
    .output {
      margin-top: 0.9rem;
      padding: 10px;
      font-size: 13px;
      background: #2a2a2a;
      border-left: 4px solid #4CAF50;
      border-radius: 8px;
      box-shadow: 0 0 6px #4caf5040;
    }
    footer {
      text-align: center;
      margin-top: 2rem;
      font-size: 11px;
      color: #888;
    }
    /* üü© –ü–æ‚Äë–≥–æ–ª—è–º –∏ —á–µ—Ç–∏–º —Ç–µ–∫—Å—Ç –∑–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ */
.output {
  font-size: 16px !important;
  font-weight: 600 !important;
  color: #ffffff !important;
  background: #1e1e1e !important;
  border-left: 5px solid #4CAF50 !important;
}

/* üü© –û—â–µ –ø–æ‚Äë–≥–æ–ª—è–º —à—Ä–∏—Ñ—Ç —Å–∞–º–æ –∑–∞ —Ä–µ—Å—Ç–æ */
#resto-result {
  font-size: 18px !important;
  font-weight: 700 !important;
  text-align: center;
  padding: 12px 15px !important;
}

/* üü© –ü–æ–¥—á–µ—Ä—Ç–∞–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –≤ –¥—Ä—É–≥–∏ —Ä–∞–∑–¥–µ–ª–∏ */
#percentOutput,
#vatGrossRes,
#vatNetRes,
#vatOnlyRes {
  font-size: 15px !important;
  font-weight: 600 !important;
}

/* üü© –ú–∞–ª–∫–æ –ø–æ–≤–µ—á–µ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ –∑–∞ –º–æ–±–∏–ª–Ω–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ */
@media (max-width: 480px) {
  .output {
    font-size: 17px !important;
    padding: 12px !important;
  }
}

  </style>
</head>

<body>
<h1>–ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä</h1>

<div class="tabs">
  <button id="tab-percent" class="active" onclick="show('percent')">üìà –ü—Ä–æ—Ü–µ–Ω—Ç–∏</button>
  <button id="tab-vat" onclick="show('vat')">üìä –î–î–°</button>
  <button id="tab-currency" onclick="show('currency')">üí± –í–∞–ª—É—Ç–∞</button>
  <button id="tab-resto" onclick="show('resto')">üíµ –†–µ—Å—Ç–æ</button>
</div>

<div id="percent" class="section active">
  <label>üí∞ –°—É–º–∞ (–æ—Ç—Å—Ç—ä–ø–∫–∞/–Ω–∞–¥—Ü–µ–Ω–∫–∞)</label>
  <input type="number" id="percentBase" oninput="calcPercent()"/>
  <label>üìâ –ü—Ä–æ—Ü–µ–Ω—Ç</label>
  <input type="number" id="percentValue" oninput="calcPercent()"/>
  <select id="percentType" onchange="calcPercent()">
    <option value="plus">+ –ù–∞–¥—Ü–µ–Ω–∫–∞</option>
    <option value="minus">‚Äì –û—Ç—Å—Ç—ä–ø–∫–∞</option>
  </select>
  <div id="percentOutput" class="output"></div>
</div>

<div id="vat" class="section">
  <label>üí∏ –°—É–º–∞ —Å –î–î–° (20%)</label>
  <input type="number" id="vatGross" oninput="calcVatGross()"/>
  <div id="vatGrossRes" class="output"></div>
  <label>üè∑Ô∏è –°—É–º–∞ –±–µ–∑ –î–î–° (20%)</label>
  <input type="number" id="vatNet" oninput="calcVatNet()"/>
  <div id="vatNetRes" class="output"></div>
  <label>üì¶ –°–∞–º–æ –î–î–° (20%)</label>
  <input type="number" id="vatOnly" oninput="calcVatOnly()"/>
  <div id="vatOnlyRes" class="output"></div>
</div>

<div id="currency" class="section">
  <label>üáßüá¨ –õ–µ–≤–∞ (BGN)</label>
  <input type="number" id="bgn" oninput="convCur('bgn')"/>
  <label>üá™üá∫ –ï–≤—Ä–æ (EUR)</label>
  <input type="number" id="eur" oninput="convCur('eur')"/>
  <div class="output">–ö—É—Ä—Å: 1 EUR = 1.95583 BGN</div>
</div>
<div id="resto" class="section">
  <label>üßæ –¶–µ–Ω–∞ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∞</label>
  <input type="number" id="price" placeholder="–Ω–∞–ø—Ä. 10.50">
  <select id="price-currency">
    <option value="BGN">BGN</option>
    <option value="EUR">EUR</option>
  </select>

  <label>üíµ –ü–ª–∞—Ç–µ–Ω–∞ —Å—É–º–∞</label>
  <input type="number" id="paid" placeholder="–Ω–∞–ø—Ä. 20.00">
  <select id="paid-currency">
    <option value="BGN">BGN</option>
    <option value="EUR">EUR</option>
  </select>

  <label>üîÅ –ü–æ–∫–∞–∂–∏ —Ä–µ—Å—Ç–æ –≤</label>
  <select id="result-currency">
    <option value="BGN">BGN</option>
    <option value="EUR">EUR</option>
  </select>

  <button onclick="calculateResto()" style="margin-top: 10px;">–ò–∑—á–∏—Å–ª–∏ —Ä–µ—Å—Ç–æ</button>
  <div id="resto-result" class="output"></div>
</div>

<footer>by Dimitar Kolev</footer>

<script>
function show(id) {
  document.querySelectorAll('.section').forEach(s => {
    s.classList.remove('active');
    s.style.display = 'none';
  });
  document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
  document.getElementById(id).style.display = 'block';
  setTimeout(() => document.getElementById(id).classList.add('active'), 20);
  document.getElementById('tab-' + id).classList.add('active');
}

function calcPercent() {
  const base = parseFloat(document.getElementById('percentBase').value) || 0;
  const pct = parseFloat(document.getElementById('percentValue').value) || 0;
  const type = document.getElementById('percentType').value;
  const result = type === 'plus' ? base * (1 + pct / 100) : base * (1 - pct / 100);
  const diff = Math.abs(result - base);
  document.getElementById('percentOutput').innerHTML =
    `–ù–æ–≤–∞ —Å—É–º–∞: ${result.toFixed(2)} –ª–≤<br>–†–∞–∑–ª–∏–∫–∞: ${diff.toFixed(2)} –ª–≤`;
}

function calcVatGross() {
  const v = parseFloat(document.getElementById('vatGross').value) || 0;
  const net20 = (v / 1.2).toFixed(2);
  const vat20 = (v - net20).toFixed(2);
  document.getElementById('vatGrossRes').innerHTML =
    `–ù–µ—Ç–Ω–∞ —Å—É–º–∞: ${net20} –ª–≤<br>–î–î–° (20%): ${vat20} –ª–≤`;
}

function calcVatNet() {
  const n = parseFloat(document.getElementById('vatNet').value) || 0;
  const gross20 = (n * 1.2).toFixed(2);
  const vat20 = (n * 0.2).toFixed(2);
  document.getElementById('vatNetRes').innerHTML =
    `–° –î–î–°: ${gross20} –ª–≤<br>–î–î–° (20%): ${vat20} –ª–≤`;
}

function calcVatOnly() {
  const d = parseFloat(document.getElementById('vatOnly').value) || 0;
  const net20 = (d / 0.2).toFixed(2);
  const gross20 = (net20 * 1.2).toFixed(2);
  document.getElementById('vatOnlyRes').innerHTML =
    `–ù–µ—Ç–Ω–∞ —Å—É–º–∞: ${net20} –ª–≤<br>–û–±—â–æ —Å –î–î–°: ${gross20} –ª–≤`;
}

function convCur(src) {
  const rate = 1.95583;
  const b = document.getElementById('bgn');
  const e = document.getElementById('eur');
  const val = parseFloat(src === 'bgn' ? b.value : e.value) || 0;
  if (src === 'bgn') e.value = (val / rate).toFixed(2);
  else b.value = (val * rate).toFixed(2);
}

function calculateResto() {
  const price = parseFloat(document.getElementById("price").value);
  const paid = parseFloat(document.getElementById("paid").value);
  const priceCurr = document.getElementById("price-currency").value;
  const paidCurr = document.getElementById("paid-currency").value;
  const resultCurr = document.getElementById("result-currency").value;
  const output = document.getElementById("resto-result");

  if (isNaN(price) || isNaN(paid)) {
    output.textContent = "–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏.";
    return;
  }

  const rate = 1.95583;
  const toEUR = val => (val / rate);
  const toBGN = val => (val * rate);

  const priceEUR = priceCurr === "EUR" ? price : toEUR(price);
  const paidEUR = paidCurr === "EUR" ? paid : toEUR(paid);
  const restoEUR = paidEUR - priceEUR;

  if (restoEUR < 0) {
    output.textContent = "–ü–ª–∞—Ç–µ–Ω–∞—Ç–∞ —Å—É–º–∞ –µ –Ω–µ–¥–æ—Å—Ç–∞—Ç—ä—á–Ω–∞.";
    return;
  }

  const finalResto = resultCurr === "EUR" ? restoEUR : toBGN(restoEUR);
  const symbol = resultCurr === "EUR" ? "‚Ç¨" : "–ª–≤.";

  output.textContent = `–†–µ—Å—Ç–æ: ${finalResto.toFixed(2)} ${symbol}`;
}
</script>
</body>
</html>
